version: 2.1

jobs:
  test:
    executor: runner
    steps:
      - checkout
      - run:
          name: Profile CPU and memory every 5s (background)
          command: |
            while true; do
              sleep 5
              printf "\n\n$(date)\n"
              top -b -c -n 1
              echo "======"
            done
          background: true
      - run: sudo apt-get install stress
      - run: sudo stress --cpu 1 --timeout 20
      
workflows:
  main:
    jobs:
      - test

executors:
  runner:
    docker:
      - image: cimg/base:stable
    resource_class: ryanpedersen/container-runner-local

# VS Code Extension Version: 1.0.0